arcfour16-drop786432-middle8
============================

arcfour16-drop786432-middle8 is a minimalistic encryption
utility, implementing a 16-bit analogue of the 8-bit ARCFOUR
algorithm.

In fact it uses exactly the same algorithm, except that all
variables are 16 bits wide except of 8 bits, and the SBOX has
2**16 instead of 2**8 entries.

Usage: arcfour16-drop786432-middle8 key_file < infile > outfile

where key_file is the name of a file containing the
encryption/decryption key.

There is no difference between encryption and decryption: If the
input is already encrypted it will be decrypted, otherwise it
will be encrypted.

Only the first 128 KiB of key_file will be read, although it may
be shorter as long as it has an even byte size.

Analyses have shown that the initial bytes generated by ARCFOUR
are not "random" enough, and SCAN recommends that at least the
first 768 bytes should be dropped, or even 3072 bytes to be more
conservative. The latter is 12 x the size if the SBOX.

arcfour16-drop786432-middle8 follows that recommendation,
dropping the first 12 x SBOX size output units generated by the
algorithm. This means the first 786432 16-bit outputs will be
dropped.

As an additional safety measure, arcfour16-drop786432-middle8
only uses the middle 8 bits of every generated 16-bit output for
actual encryption.

Instead of a password, arcfour16-drop786432-middle8 requires a
binary key file which consists of an even number of bytes. This
file will be read as a sequence of 16-bit units in big-endian
byte order which represent the encryption key.

This file could also be a text file, the utility does not care as
long as it consists of an even number of bytes.

ARCFOUR is a stream cipher, and it is therefore important that
the same key is never used for more than one message.

It is therefore recommended that the key consists of a password
which may be used for more than one message and a nonce which is
only used once but need not be secret.

The binary key could then be created from two files containing
the password and nonce as follows:

$ cat nonce.bin password.txt nonce.bin > key.bin

Other than the password, the nonce does not need to be secret and
can then be sent along with the encrypted file.

nonce.bin can either be a simple text file containing a counter
which is incremented for every message using the same key, or
consist of binary random data long enough to make it extremely
unlikely the same nonce may ever generated again by accident.

Like password.txt, nonce.bin should consist of an even number of
bytes to ensure the concatenated binary key is also made up of an
even number of bytes.

This is how to use a counter as file nonce.bin:

$ read c 2> /dev/null < nonce.bin || c=0; \
printf '%011u\n' `expr $c + 1` | tee nonce.bin

And here is how to use a random number as nonce:

$ dd if=/dev/urandom bs=1 count=24 2> /dev/null > nonce.bin

Before using your password.txt, check that its byte size is even.
If not, edit it and add another character to the password,
padding it to an even number of bytes. The padding character has
no effect on security, so it is OK to always use the same
character and it does not need to be kept secret.

Here is to how to properly pad password.txt with a zero byte
(which is as good as any other padding value) if necessary:

$ expr `wc -c < password.txt` % 2 = 0 > /dev/null \
|| printf '\0' >> password.txt 

Copyright (c) 2017 Guenther Brunthaler. All rights reserved.

This program is free software.
Distribution is permitted under the terms of the GPLv3.

The UUID of this project is 35944240-73a2-11e7-86f3-b827eb0d201c.
